\documentclass[10pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc,url}
\usepackage{parskip}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{verbatim}
\usepackage{amsmath, amssymb}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{physics}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{listings}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{float}
\usepackage{epigraph}
\usepackage{hyperref}


\newcommand{\indexset}{\mathcal{I}}
\newcommand{\indexsetinner}{\mathcal{I}_{\mathrm{inner}}}
\newcommand{\bigO}{{\mathcal{O}}}
\newcommand{\bigtheta}{\Theta}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\dt}{{\Delta t}}
\newcommand{\dx}{{\Delta x}}
\newcommand{\dy}{{\Delta y}}
\newcommand{\du}{{\Delta u}}
\newcommand{\pt}{{\partial t}}
\newcommand{\px}{{\partial x}}
\newcommand{\py}{{\partial y}}
\newcommand{\pu}{{\partial u}}
\newcommand{\ppu}{{\partial^2 u}}

\begin{document}



\title{FYS3150 -- Project 5 -- PDE}
\author{
	\begin{tabular}{rl}
        Kristian Gregorius Hustad & (\texttt{krihus})\\
        Jonas Gahr Sturtzel Lunde & (\texttt{jonassl})
	\end{tabular}}
\date{December 9, 2016}
\maketitle



\setlength{\epigraphwidth}{0.75\textwidth}
\renewcommand{\epigraphflush}{center}
\renewcommand{\beforeepigraphskip}{50pt}
\renewcommand{\afterepigraphskip}{100pt}
\renewcommand{\epigraphsize}{\normalsize}
\epigraph{Nobody reads my lecture notes}
	{\textit{Morten Hjorth-Jensen}}

\begin{abstract}
\noindent
This is an abstract
\end{abstract}

\pagebreak




\textbf{TODO}: Remember to cite \cite{hpl_fdm}!

\section{Introduction}
We will be solving the partial differential equation
\begin{equation}\label{eqn:PDE}
\frac{\pu(x_i,t_j)^2}{\px^2} = \frac{\pu(x_i,t_j)}{\pt}
\end{equation}

\section{Method and Idea}
\subsection{One dimmentional case}
\subsubsection{Disrectization}
\begin{equation}
u(x+\dx, t+\dt) = u(x_{i+1},t_{i+1}) = u_{i+1,j+1}
\end{equation}

\subsubsection{Forward Euler - Explicit scheme}
We will be approximating the partial differential equation \ref{eqn:PDE} with the explicit scheme by Taylor expansion around $u(x,t)$. Truncating at the first derivative, we get.
\begin{equation}
u(x,t+\dt) = u(x,t) + \frac{\pu(x,t)}{\pt}\dt + O(\dt^2)
\end{equation}

\begin{equation}
\frac{\pu(x,t)}{\pt} = \frac{u(x,t+\dt) - u(x,t)}{\dt} + \frac{O(\dt^2)}{\dt} \approx \frac{u(x,t+\dt) - u(x,t)}{\dt}
\end{equation}
giving a trucation error running as $\dt$.
\\
\\
\\
Central difference:
\begin{equation}
u(x+\Delta x, t) = u(x,t) + \frac{\pu(x,t)}{\px}\dx + \frac{\ppu(x,t)}{2\px^2}\dx^2 + O(\dx^3)
\end{equation}

\begin{equation}
u(x-\Delta x, t) = u(x,t) - \frac{\pu(x,t)}{\px}\dx + \frac{\ppu(x,t)}{2\px^2}\dx^2 + O(\dx^3)
\end{equation}

\begin{equation}
u(x+\Delta x, t) + u(x-\Delta x, t) = 2u(x,t) + 2\frac{\ppu(x,t)}{2\px^2}\dx^2 + 2O(\dx^3)
\end{equation}

\begin{equation}\begin{split}
\frac{\ppu(x,t)}{2\px^2} &= \frac{u(x+\Delta x, t) - 2u(x,t) + u(x-\Delta x, t)}{\dx^2} + \frac{2O(\dx^3)}{\dx^2}\\
&\approx \frac{u(x+\Delta x, t) - 2u(x,t) + u(x-\Delta x, t)}{\dx^2}
\end{split}\end{equation}


\begin{equation}
\frac{\ppu(x,t)}{\px^2} = \frac{2u(x+\dx,t) - 2u(x,t)}{\dx^2} - \frac{2\frac{\pu(x,t)}{\px}}{\dx}
\end{equation}

\begin{equation}
\frac{u(x_i + \dx, t_j) - 2u(x_i,t_j) + u(x_i - \dx, t_j)}{\dx^2}
= \frac{u(x_i, t_j + \dt) - u(x_i, t_i)}{\dt}
\end{equation}

which we can discretize as
\begin{equation}
\frac{u_{i+1,j} - 2u_{i,j}+u_{i-1,j}}{\dx^2} = \frac{u_{i,j+1} - u_{i,j}}{\dt}
\end{equation}

which gives
\begin{equation}
u_{i,j+1} = \alpha u_{i-1,j} + (1-2\alpha)u_{i,j} + \alpha u_{i+1,j}
\end{equation}
where $\alpha = \frac{\dt}{\dx^2}$ is a known constant.


\subsubsection{Backward Euler - Implicit scheme}
\begin{align}
\frac{u_{i+1,j} - 2u_{i,j}+u_{i-1,j}}{\dx^2} &= \frac{u_{i,j} - u_{i,j-1}}{\dt} \\
u_{i,j-1} = \alpha u_{i+1,j} + (1 - 2\alpha )u_{i,j} + \alpha u_{i-1,j}
\end{align}

we define
\[
Â = \begin{bmatrix}
1+2\alpha & -\alpha & 0 & \cdots & \cdots \\
-\alpha & 1+2\alpha & -\alpha & \cdots & \vdots \\
0 & \ddots & \ddots & \ddots & \vdots \\
\vdots & \ddots & \ddots & \ddots & -\alpha \\
\vdots & \cdots & \cdots & -\alpha & 1+2\alpha \\
\end{bmatrix}
\]
and
\[ V_j = \begin{bmatrix}
u_{0,j}\\
u_{1,j}\\
\cdots\\
u_{n-1,j}\\
u_{n,j}\\
\end{bmatrix}
\]
and get
\begin{equation}
ÂV_j = V_{j-1}
\end{equation}
which means we can define the state at time $j$, $V_j$ as
\begin{equation}
V_j = Â^{-j}V_0
\end{equation}


\subsubsection{The Crank-Nicolson scheme}


\subsubsection{The truncation error}


\subsection{Two dimmentional case}
\begin{equation}
\left(\frac{\ppu(x,y,t)}{\px^2} + \frac{\ppu(x,y,t)}{\py^2}\right) = \frac{\pu(x,y,t)}{\pt}
\end{equation}
Forward Euler
\begin{equation}
\frac{u_{i+1,j}^l - 2u_{i,j}^l + u_{i-1,j}^l}{h^2} + \frac{u_{i,j+1}^l - 2u_{i,j}^l + u_{i,j-1}^l}{h^2} = \frac{u_{i,j}^{l+1} - u_{i,j}^l}{\dt}
\end{equation}

\begin{equation}
u_{i,j}^{l+1} = u_{i,j}^l + \alpha\left( u_{i+1,j}^l + u_{i-1,j}^l + u_{i,j+1}^l + u_{i,j+1}^l - 4u_{i,j}^l \right)
\end{equation}



\section{Implementation and results}\label{sec:implementation_and_results}

\input{chapters/notes_on_implementation.tex}

\bibliographystyle{IEEEtran}
\bibliography{../papers}{}

\end{document}
