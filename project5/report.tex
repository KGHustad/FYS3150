\documentclass[10pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc,url}
\usepackage{parskip}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{verbatim}
\usepackage{amsmath, amssymb}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{physics}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{listings}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{float}
\usepackage{epigraph}
\usepackage{hyperref}
\usepackage{varioref}

% varioref stuff from Anders
\labelformat{section}{section~#1}
\labelformat{subsection}{section~#1}
\labelformat{subsubsection}{paragraph~#1}
\labelformat{equation}{(#1)}
\labelformat{figure}{figure~#1}
\labelformat{table}{table~#1}

\newcommand{\indexset}{\mathcal{I}}
\newcommand{\indexsetinner}{\mathcal{I}_{\mathrm{inner}}}
\newcommand{\bigO}{{\mathcal{O}}}
\newcommand{\bigtheta}{\Theta}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\dt}{{\Delta t}}
\newcommand{\dx}{{\Delta x}}
\newcommand{\dy}{{\Delta y}}
\newcommand{\du}{{\Delta u}}
\newcommand{\fracpt}{\frac{\partial}{\partial t}}
\newcommand{\fracpx}{\frac{\partial}{\partial x}}
\newcommand{\fracpy}{\frac{\partial}{\partial y}}
\newcommand{\fracpxx}{\frac{\partial^2}{\partial x^2}}
\newcommand{\fracpyy}{\frac{\partial^2}{\partial y^2}}
\newcommand{\pt}{{\partial t}}
\newcommand{\px}{{\partial x}}
\newcommand{\py}{{\partial y}}
\newcommand{\pu}{{\partial u}}
\newcommand{\ppu}{{\partial^2 u}}

\begin{document}



\title{FYS3150 -- Project 5 -- PDE}
\author{
	\begin{tabular}{rl}
        Kristian Gregorius Hustad & (\texttt{krihus})\\
        Jonas Gahr Sturtzel Lunde & (\texttt{jonassl})
	\end{tabular}}
\date{December 9, 2016}
\maketitle



\setlength{\epigraphwidth}{0.75\textwidth}
\renewcommand{\epigraphflush}{center}
\renewcommand{\beforeepigraphskip}{50pt}
\renewcommand{\afterepigraphskip}{100pt}
\renewcommand{\epigraphsize}{\normalsize}
\epigraph{Nobody reads my lecture notes}
	{\textit{Morten Hjorth-Jensen}}

\begin{abstract}
\noindent
This is an abstract
\end{abstract}

\vfill


\begin{center}
    GitHub repository at \url{https://github.com/KGHustad/FYS3150}
    or \url{https://github.uio.no/krihus/FYS3150} (UiO mirror)
\end{center}


\pagebreak




\textbf{TODO}: Remember to cite \cite{hpl_fdm}!

\section{Introduction}
We wish to study numerical implementation of partial differential equations, using finite difference schemes. The partial differential equation we have chosen, is a simplified case of the diffusion equation, written as \ref{eqn:PDE} in one dimmention, and \ref{eqn:PDE2} in two dimmentions. The spatial derivatives on the left side will be approximated with central difference, and the time-derivative on the right using Forward Euler, Backward Euler, and the Crank-Nicolson scheme.
\begin{equation}\label{eqn:PDE}
\frac{\ppu(x,t)}{\px^2} = \frac{\pu(x,t)}{\pt}
\end{equation}

\begin{equation}\label{eqn:PDE2}
\frac{\ppu(x,y,t)}{\px^2} + \frac{\ppu(x,y,t)}{\py^2} = \frac{\pu(x,t)}{\pt}
\end{equation}

\section{Method and Idea}
\subsection{Discretization and notation}\label{sec:disc}
The spatial dimentions will be discretized as points
\begin{equation} (x_i), \ i \in [0,n+1] \end{equation}
in the one dimmentional case, and points 
\begin{equation} (x_i, y_j), \ i,j \in [0,n+1]\end{equation}
in the two-dimmentional case.\\
The time will be discretized as
\begin{equation} t_l, \ l \in [0,N+1] \end{equation}
We will also rewrite this to the following compact notation, in one dimension:
\begin{equation}
u(x+\dx, t+\dt) = u(x_{i+1},t_{l+1}) = u_{i+1}^{l+1}
\end{equation}
and two dimensions:
\begin{equation}
u(x+\dx, y+\dy, t+\dt) = u(x_{i+1}, y_{j+1}, t_{l+1}) = u_{i+1,j+1}^{l+1}
\end{equation}

We will also write the derivatives in \ref{eqn:PDE} and \ref{eqn:PDE2} with the compact notations
\begin{equation} u_{xx} = u_t\end{equation}
\begin{equation} \ u_{xx} + u_{yy} = u_t \end{equation}

\subsection{One dimentional case}

\subsubsection{Central difference scheme}
For the spatial derivative of the partial differential equation, we will be using the centered difference scheme, derived from a Taylor expansion in both directions around $u(x,t)$.
\begin{equation}
u(x+\Delta x, t) = u(x,t) + \frac{\pu(x,t)}{\px}\dx + \frac{\ppu(x,t)}{2\px^2}\dx^2 + O(\dx^3)
\end{equation}

\begin{equation}
u(x-\Delta x, t) = u(x,t) - \frac{\pu(x,t)}{\px}\dx + \frac{\ppu(x,t)}{2\px^2}\dx^2 + O(\dx^3)
\end{equation}

\begin{equation}
u(x+\Delta x, t) + u(x-\Delta x, t) = 2u(x,t) + 2\frac{\ppu(x,t)}{2\px^2}\dx^2 + 2O(\dx^3)
\end{equation}

\begin{equation}\begin{split}
\frac{\ppu(x,t)}{2\px^2} &= \frac{u(x+\Delta x, t) - 2u(x,t) + u(x-\Delta x, t)}{\dx^2} + \frac{2O(\dx^3)}{\dx^2}\\
&\approx \frac{u(x+\Delta x, t) - 2u(x,t) + u(x-\Delta x, t)}{\dx^2}
\end{split}\end{equation}
Giving a truncation error running as $\dx$.\\\\
We can discretize the derivative as shown in \ref{sec:disc}, giving
\begin{equation}
u_{xx} = \frac{u_{i+1}^l - 2u_i^l+u_{i-1}^l}{\dx^2}
\end{equation}


\subsubsection{Forward Euler - Explicit scheme}
To approximate the time derivative of the partial differential equation \ref{eqn:PDE}, we will first derive the explicit Forward Euler method, by Taylor expansion around $u(x,t)$. Truncating after the first derivative, we get
\begin{equation}
u(x,t+\dt) = u(x,t) + \frac{\pu(x,t)}{\pt}\dt + O(\dt^2)
\end{equation}
Solving for the time derivative gives
\begin{equation}
\frac{\pu(x,t)}{\pt} = \frac{u(x,t+\dt) - u(x,t)}{\dt} + \frac{O(\dt^2)}{\dt} \approx \frac{u(x,t+\dt) - u(x,t)}{\dt}
\end{equation}
which means we have a truncation error running as $\dt$.
\\\\
We can discretize this as shown in \ref{sec:disc}, giving
\begin{equation}
u_t = \frac{u_i^{l+1} - u_i^l}{\dt}
\end{equation}
Combining this with the central difference scheme, we get the approximation to the partial differential equation \vref{eqn:PDE}
\begin{equation}
\frac{u_{i+1}^l - 2u_i^l+u_{i-1}^l}{\dx^2} = \frac{u_i^{l+1} - u_i^l}{\dt}
\end{equation}

Solving for $u_i^{l+1}$, and introducing the known constant $\alpha = \frac{\dt}{\dx^2}$, we arrive at the explicit scheme
\begin{equation}
u_i^{l+1} = \alpha u_{i-1}^l + (1-2\alpha)u_i^l + \alpha u_{i+1}^l
\end{equation}
We see that the state of the system at a time, $t_{l+1}$(left side), only depends on the conditions of the system in a previous state, $t_l$(right side).

\subsubsection{Backward Euler - Implicit scheme}
We will now derive the implicit Backward Euler method to approximate the time derivative of the partial differential equation. Taylor expanding backwards around $u(x,t)$, truncating after the first derivative, we get
\begin{equation}
u(x,t-\dt) = u(x,t) - \frac{\pu(x,t)}{\pt}\dt + O(\dt^2)
\end{equation}
Solving for the time derivate gives
\begin{equation}
\frac{\pu(x,t)}{\pt} = \frac{u(x,t) - u(x,t-\dt)}{\dt} + \frac{O(\dt^2)}{\dt} \approx \frac{u(x,t) - u(x,t-\dt)}{\dt}
\end{equation}
giving a truncation error running as $\dt$, just as the explicit scheme.
\\\\
We can discretize this as shown in \ref{sec:disc}, giving
\begin{equation}
u_t = \frac{u_i^l - u_i^{l-1}}{\dt}
\end{equation}
Again combining with the central difference, we approximate the partial differential equation as
\begin{equation}
\frac{u_{i+1}^l - 2u_i^l+u_{i-1}^l}{\dx^2} = \frac{u_i^l - u_i^{l-1}}{\dt}
\end{equation}
Again introducing $\alpha = \frac{\dt}{\dx^2}$, we can rewrite to
\begin{equation}\label{eqn:implicit}
u_i^{l-1} = -\alpha u_{i+1}^l + (1 + 2\alpha )u_i^l + -\alpha u_{i-1}^l
\end{equation}
\\
We see that we cannot write the state of the system as an explicit function of a previous state, making this an implicit scheme. If we write \ref{eqn:implicit} out for all values of $i \in [0,n+1]$, we see that it becomes a set of linear equations, which we will write as the matrix equation
\begin{equation}
V_{l-1} = \hat{A}V_l
\end{equation}
where we define the three-diagonal matrix:
\begin{equation}
\hat{A} = \begin{bmatrix}
1+2\alpha & -\alpha & 0 & \cdots & \cdots \\
-\alpha & 1+2\alpha & -\alpha & \cdots & \vdots \\
0 & \ddots & \ddots & \ddots & \vdots \\
\vdots & \ddots & \ddots & \ddots & -\alpha \\
\vdots & \cdots & \cdots & -\alpha & 1+2\alpha \\
\end{bmatrix}
\end{equation}
and the state of the system at a given time $t_l$:
\begin{equation}\label{eqn:V} V_l = \begin{bmatrix}
u_{0}^l\\
u_{1}^l\\
\cdots\\
u_{n}^l\\
u_{n+1}^l\\
\end{bmatrix}
\end{equation}
This means we can define the state of the system, $V_l$, at time, $t_l$, as
\begin{equation}
V_l = \hat{A}^{-l}V_0
\end{equation}



\subsubsection{The Crank-Nicolson scheme}
\textbf{TODO}: Deriving crank-nicolson scheme, resulting in:

\begin{equation}
\frac{1}{2\dx^2}\left(u_{i-1}^l - 2u_i^l + u_{i+1}^l\right) - \frac{1}{2\dx^2}\left(u_{i+1}^l - 2u_i^{l-1} + u_{u-1}^{l-1}\right) = \frac{1}{\dt}\left(u_i^l-u_i^{l-1}\right)
\end{equation}
which, after again defining $\alpha = \frac{\dt}{\dx^2}$, we get
\begin{equation}
-\alpha u_{i-1}^l + (2+2\alpha)u_i^l - \alpha u_{i+1}^l = \alpha u_{i-1}^{l-1} + (2-2\alpha)u_i^{l-1} + \alpha u_{i+1}^{l-1}
\end{equation}
As with the Backward Euler scheme, we write this as a system of linear equations for $i \in [0,n+1]$, which can be written as the matrix equation
\begin{equation}\label{eqn:crank}
(2\hat{I}+\alpha \hat{B})V_l = (2\hat{I}-\alpha \hat{B})V_{l-1}
\end{equation}
where $V_l$ is defined in \vref{eqn:V}. We also have the identity matrix $\hat{I}$, and the three-diagononal matrix:

\[
\hat{B} = \begin{bmatrix}
2 & -1 & 0 & \cdots & \cdots \\
-1 & 2 & -1 & 0 & \vdots \\
\vdots & \ddots & \ddots & \ddots & \vdots \\
\vdots & \ddots & \ddots & 0 & -1 \\
\vdots & \cdots & 0 & -1 & 2 \\
\end{bmatrix}
\]

We can rewrite \vref{eqn:crank} to define the state of the system $V_l$ as a function of it's inital state $V_0$:
\begin{equation}
V_l = (2\hat{I}+\alpha \hat{B})^{-1} (2\hat{I} - \alpha \hat{B})V_{l-1}
\end{equation}



\subsection{Error and stabitlity}
\subsubsection{The truncation error}


\subsection{An analytical solution}\label{sec:analytical_1d}
\cite{inf-mat2351_book} gives a solution to the diffusion equation

\begin{align}\label{eq:analytical_1d_book}
    u(x, t) = e^{-\pi^2 t} \sin(\pi x) , \quad u(0, t) = u(1, t) = 0
\end{align}

We can easily show that \vref{eq:analytical_1d_book} solves \vref{eqn:PDE},
\begin{align}
\fracpt u(x, t) &= -\pi^2 u(x, t) \\
\fracpxx u(x, t) &= \fracpx \left(\pi e^{-\pi^2 t} \cos(\pi x) \right)
= -\pi^2 e^{-\pi^2 t} \sin(\pi x) = -\pi^2 u(x, t)
\end{align}



\subsection{Two dimensional case}
\begin{equation}
\left(\frac{\ppu(x,y,t)}{\px^2} + \frac{\ppu(x,y,t)}{\py^2}\right) = \frac{\pu(x,y,t)}{\pt}
\label{eq:diffusion_2d}
\end{equation}
Forward Euler
\begin{equation}
\frac{u_{i+1,j}^l - 2u_{i,j}^l + u_{i-1,j}^l}{h^2} + \frac{u_{i,j+1}^l - 2u_{i,j}^l + u_{i,j-1}^l}{h^2} = \frac{u_{i,j}^{l+1} - u_{i,j}^l}{\dt}
\end{equation}

\begin{equation}
u_{i,j}^{l+1} = u_{i,j}^l + \alpha\left( u_{i+1,j}^l + u_{i-1,j}^l + u_{i,j+1}^l + u_{i,j+1}^l - 4u_{i,j}^l \right)
\end{equation}

\subsubsection{An analytical solution}
We can adapt the analytical solution described in \vref{sec:analytical_1d} to solve the 2D problem.

Using the Dirichlet boundary conditions
\begin{align}
u(0, y, t) = u(1, y, t) = u(x, 0, t) = u(x, 1, t) = 0
\end{align}
we get
\begin{align}\label{eq:analytical_2d}
    u(x, y, t) = e^{-2\pi^2 t} \sin(\pi x) \sin(\pi y)
\end{align}

which solves \vref{eq:diffusion_2d} since
\begin{align}
\fracpt u(x, y, t) &= -2\pi^2 u(x, y, t) \\
\fracpxx u(x, y, t) &= \fracpx \left( \pi e^{-2\pi^2 t} \cos(\pi x) \sin(\pi y) \right) \\
&= -\pi^2 e^{-2\pi^2 t} \sin(\pi x) \sin(\pi y) \\
&= -\pi^2 u(x, y, t) \\
\fracpyy u(x, y, t) &= \fracpy \left( \pi e^{-2\pi^2 t} \sin(\pi x) \cos(\pi y) \right) \\
&= -\pi^2 e^{-2\pi^2 t} \sin(\pi x) \sin(\pi y) \\
&= -\pi^2 u(x, y, t)
\end{align}

\section{Implementation and results}\label{sec:implementation_and_results}

\input{chapters/notes_on_implementation.tex}

\bibliographystyle{IEEEtran}
\bibliography{../papers}{}

\end{document}
