\documentclass[10pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc,url}
\usepackage{parskip}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{verbatim}
\usepackage{amsmath, amssymb}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{physics}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{listings}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{float}
\usepackage{epigraph}
\usepackage{hyperref}


\newcommand{\indexset}{\mathcal{I}}
\newcommand{\indexsetinner}{\mathcal{I}_{\mathrm{inner}}}
\newcommand{\bigO}{{\mathcal{O}}}
\newcommand{\bigtheta}{\Theta}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\dt}{{\Delta t}}
\newcommand{\dx}{{\Delta x}}
\newcommand{\dy}{{\Delta y}}
\newcommand{\du}{{\Delta u}}
\newcommand{\pt}{{\partial t}}
\newcommand{\px}{{\partial x}}
\newcommand{\py}{{\partial y}}
\newcommand{\pu}{{\partial u}}
\newcommand{\ppu}{{\partial^2 u}}

\begin{document}



\title{FYS3150 -- Project 5 -- PDE}
\author{
	\begin{tabular}{rl}
        Kristian Gregorius Hustad & (\texttt{krihus})\\
        Jonas Gahr Sturtzel Lunde & (\texttt{jonassl})
	\end{tabular}}
\date{December 9, 2016}
\maketitle



\setlength{\epigraphwidth}{0.75\textwidth}
\renewcommand{\epigraphflush}{center}
\renewcommand{\beforeepigraphskip}{50pt}
\renewcommand{\afterepigraphskip}{100pt}
\renewcommand{\epigraphsize}{\normalsize}
\epigraph{Nobody reads my lecture notes}
	{\textit{Morten Hjorth-Jensen}}

\begin{abstract}
\noindent
This is an abstract
\end{abstract}

\pagebreak




\textbf{TODO}: Remember to cite \cite{hpl_fdm}!

\section{Introduction}
We will be solving the partial differential equation
\begin{equation}\label{eqn:PDE}
\frac{\pu(x_i,t_j)^2}{\px^2} = \frac{\pu(x_i,t_j)}{\pt}
\end{equation}
by approximating the left side with the central difference scheme, and the right side by Forward and Backward Euler, and the Crank-Nicolson scheme.

\section{Method and Idea}
\subsection{One dimmentional case}
\subsubsection{Disrectization}\label{sec:disc}
One dimmention:
\begin{equation}
u(x+\dx, t+\dt) = u(x_{i+1},t_{i+1}) = u_{i+1}^{j+1}
\end{equation}
Two dimmentions:
\begin{equation}
u(x+\dx, y+\dy, t+\dt) = u(x_{i+1}, y_{i+1}, t_{i+1}) = u_{i+1,j+1}^{j+1}
\end{equation}


\subsubsection{Central difference scheme}
For the spacial derivative of the partial differential equation, we will be using the central difference scheme, derived from a Taylor expansion in both directions around $u(x,t)$.
\begin{equation}
u(x+\Delta x, t) = u(x,t) + \frac{\pu(x,t)}{\px}\dx + \frac{\ppu(x,t)}{2\px^2}\dx^2 + O(\dx^3)
\end{equation}

\begin{equation}
u(x-\Delta x, t) = u(x,t) - \frac{\pu(x,t)}{\px}\dx + \frac{\ppu(x,t)}{2\px^2}\dx^2 + O(\dx^3)
\end{equation}

\begin{equation}
u(x+\Delta x, t) + u(x-\Delta x, t) = 2u(x,t) + 2\frac{\ppu(x,t)}{2\px^2}\dx^2 + 2O(\dx^3)
\end{equation}

\begin{equation}\begin{split}
\frac{\ppu(x,t)}{2\px^2} &= \frac{u(x+\Delta x, t) - 2u(x,t) + u(x-\Delta x, t)}{\dx^2} + \frac{2O(\dx^3)}{\dx^2}\\
&\approx \frac{u(x+\Delta x, t) - 2u(x,t) + u(x-\Delta x, t)}{\dx^2}
\end{split}\end{equation}
Giving a truncation error running as $\dx$.\\\\
Which we can discretize as
\begin{equation}
u_{xx} = \frac{u_{i+1}^l - 2u_i^l+u_{i-1}^l}{\dx^2}
\end{equation}


\subsubsection{Forward Euler - Explicit scheme}
We will be approximating the partial differential equation \ref{eqn:PDE} with the explicit scheme by Taylor expansion around $u(x,t)$. Truncating at the first derivative, we get.
\begin{equation}
u(x,t+\dt) = u(x,t) + \frac{\pu(x,t)}{\pt}\dt + O(\dt^2)
\end{equation}

\begin{equation}
\frac{\pu(x,t)}{\pt} = \frac{u(x,t+\dt) - u(x,t)}{\dt} + \frac{O(\dt^2)}{\dt} \approx \frac{u(x,t+\dt) - u(x,t)}{\dt}
\end{equation}
giving a trucation error running as $\dt$.
\\\\
We can discretize this as explained in section \ref{sec:disc}, giving
\begin{equation}
u_t = \frac{u_i^{l+1} - u_i^l}{\dt}
\end{equation}
which gives
\begin{equation}
\frac{u_{i+1}^l - 2u_i^l+u_{i-1}^l}{\dx^2} = \frac{u_i^{l+1} - u_i^l}{\dt}
\end{equation}

Solving for $u_i^{l+1}$
\begin{equation}
u_i^{l+1} = \alpha u_{i-1}^l + (1-2\alpha)u_i^l + \alpha u_{i+1}^l
\end{equation}
where $\alpha = \frac{\dt}{\dx^2}$ is a known constant.


\subsubsection{Backward Euler - Implicit scheme}
Taylor expanding backwards around $u(x,t)$, truncating after the first derivative.
\begin{equation}
u(x,t-\dt) = u(x,t) - \frac{\pu(x,t)}{\pt}\dt + O(\dt^2)
\end{equation}

\begin{equation}
\frac{\pu(x,t)}{\pt} = \frac{u(x,t) - u(x,t-\dt)}{\dt} + \frac{O(\dt^2)}{\dt} \approx \frac{u(x,t) - u(x,t-\dt)}{\dt}
\end{equation}
giving a trucation error running as $\dt$.
\\\\
We can discretize this as
\begin{equation}
u_t = \frac{u_i^l - u_i^{l-1}}{\dt}
\end{equation}
which gives us the approximation to the partial differential equation
\begin{equation}
\frac{u_{i+1}^l - 2u_i^l+u_{i-1}^l}{\dx^2} = \frac{u_i^l - u_i^{l-1}}{\dt}
\end{equation}
which can be rewritten to
\begin{equation}\label{eqn:implicit}
u_i^{l-1} = \alpha u_{i+1}^l + (1 - 2\alpha )u_i^l + \alpha u_{i-1}^l
\end{equation}

we define
\[
Â = \begin{bmatrix}
1+2\alpha & -\alpha & 0 & \cdots & \cdots \\
-\alpha & 1+2\alpha & -\alpha & \cdots & \vdots \\
0 & \ddots & \ddots & \ddots & \vdots \\
\vdots & \ddots & \ddots & \ddots & -\alpha \\
\vdots & \cdots & \cdots & -\alpha & 1+2\alpha \\
\end{bmatrix}
\]
and
\[ V_l = \begin{bmatrix}
u_{0}^l\\
u_{1}^l\\
\cdots\\
u_{n-1}^l\\
u_{n}^l\\
\end{bmatrix}
\]
and rewrite \ref{eqn:implicit} as the matrix equation
\begin{equation}
ÂV_l = V_{l-1}
\end{equation}
which means we can define the state at time $l$, $V_l$ as
\begin{equation}
V_l = Â^{-l}V_0
\end{equation}


\subsubsection{The Crank-Nicolson scheme}


\subsubsection{The truncation error}


\subsection{Two dimmentional case}
\begin{equation}
\left(\frac{\ppu(x,y,t)}{\px^2} + \frac{\ppu(x,y,t)}{\py^2}\right) = \frac{\pu(x,y,t)}{\pt}
\end{equation}
Forward Euler
\begin{equation}
\frac{u_{i+1,j}^l - 2u_{i,j}^l + u_{i-1,j}^l}{h^2} + \frac{u_{i,j+1}^l - 2u_{i,j}^l + u_{i,j-1}^l}{h^2} = \frac{u_{i,j}^{l+1} - u_{i,j}^l}{\dt}
\end{equation}

\begin{equation}
u_{i,j}^{l+1} = u_{i,j}^l + \alpha\left( u_{i+1,j}^l + u_{i-1,j}^l + u_{i,j+1}^l + u_{i,j+1}^l - 4u_{i,j}^l \right)
\end{equation}



\section{Implementation and results}\label{sec:implementation_and_results}

\input{chapters/notes_on_implementation.tex}

\bibliographystyle{IEEEtran}
\bibliography{../papers}{}

\end{document}
